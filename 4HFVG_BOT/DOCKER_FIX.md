# Docker Setup - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## –ü—Ä–æ–±–ª–µ–º–∞
–û—à–∏–±–∫–∞: `not a directory: unknown: Are you trying to mount a directory onto a file`

–≠—Ç–∞ –æ—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –∏–∑-–∑–∞ –ø–æ–ø—ã—Ç–∫–∏ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª `state.json`.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞:

### 1. docker-compose.yml
- –£–±—Ä–∞–Ω–æ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `state.json`
- –û—Å—Ç–∞–≤–ª–µ–Ω–æ —Ç–æ–ª—å–∫–æ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `logs/`
- `state.json` —Ç–µ–ø–µ—Ä—å —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

### 2. –°–æ–∑–¥–∞–Ω—ã —Å–∫—Ä–∏–ø—Ç—ã

**docker-run.sh** - –ø—Ä–æ—Å—Ç–æ–π –∑–∞–ø—É—Å–∫:
```bash
./docker-run.sh
```

**docker-start.sh** - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å –º–µ–Ω—é

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
```bash
cd 4HFVG_BOT

# –°–æ–∑–¥–∞–π—Ç–µ .env –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
cp .env.example .env
nano .env  # –¥–æ–±–∞–≤—å—Ç–µ API –∫–ª—é—á–∏
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å–∫
```bash
# –ü—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±
./docker-run.sh

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é
mkdir -p logs
docker-compose up -d
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞
```bash
# –õ–æ–≥–∏
docker-compose logs -f

# –°—Ç–∞—Ç—É—Å
docker-compose ps
```

## üìù –í–∞–∂–Ω–æ: state.json

‚ö†Ô∏è **state.json –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ –ù–ï –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–µ–Ω –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞**

### –ö–∞–∫ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å state.json

#### –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å state.json –Ω–∞—Ä—É–∂—É
docker cp 4hfvg-bot:/app/state.json ./state.json

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
cat state.json | python -m json.tool
```

#### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ state.json:
```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker cp ./state.json 4hfvg-bot:/app/state.json

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
docker-compose restart
```

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
# –°–æ–∑–¥–∞—Ç—å cron job –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞–∂–¥—ã–π —á–∞—Å
0 * * * * docker cp 4hfvg-bot:/app/state.json /backup/state_$(date +\%Y\%m\%d_\%H\%M).json
```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ state.json, –µ—Å—Ç—å –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –î–æ–±–∞–≤–∏—Ç—å named volume (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `docker-compose.yml`:
```yaml
volumes:
  - ./logs:/app/logs
  - bot-state:/app  # –î–æ–±–∞–≤–∏—Ç—å —ç—Ç—É —Å—Ç—Ä–æ–∫—É

# –í –∫–æ–Ω—Ü–µ —Ñ–∞–π–ª–∞ –¥–æ–±–∞–≤–∏—Ç—å:
volumes:
  bot-state:
```

**–ü–ª—é—Å—ã**: –ü–æ–ª–Ω–∞—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
**–ú–∏–Ω—É—Å—ã**: –°–ª–æ–∂–Ω–µ–µ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º

### –í–∞—Ä–∏–∞–Ω—Ç 2: –°–æ–∑–¥–∞—Ç—å state.json –∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ —Ñ–∞–π–ª

```bash
# –°–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç–æ–π —Ñ–∞–π–ª
echo '{}' > state.json

# –û–±–Ω–æ–≤–∏—Ç—å docker-compose.yml:
volumes:
  - ./logs:/app/logs
  - ./state.json:/app/state.json  # –î–æ–±–∞–≤–∏—Ç—å —ç—Ç—É —Å—Ç—Ä–æ–∫—É
```

**–ü–ª—é—Å—ã**: –õ–µ–≥–∫–∏–π –¥–æ—Å—Ç—É–ø –∫ state.json
**–ú–∏–Ω—É—Å—ã**: –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ñ–∞–π–ª –¥–æ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# 1. –ë–∏–ª–¥
docker-compose build

# 2. –ó–∞–ø—É—Å–∫
docker-compose up

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–æ–∫
# Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

# 4. –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ
docker-compose up -d

# 5. –õ–æ–≥–∏
docker-compose logs -f
```

## üõ†Ô∏è Troubleshooting

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å—Ä–∞–∑—É –ø–∞–¥–∞–µ—Ç
```bash
# –°–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏
docker-compose logs

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
docker-compose config
```

### –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ logs
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–∑–¥–∞–Ω–∞
ls -la logs/

# –°–æ–∑–¥–∞—Ç—å –≤—Ä—É—á–Ω—É—é
mkdir -p logs
chmod 777 logs
```

### State –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
docker inspect 4hfvg-bot | grep Mounts -A 20

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å docker cp –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
docker cp 4hfvg-bot:/app/state.json ./backup_state.json
```

## üìö –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏

### –ü—Ä–æ—Å–º–æ—Ç—Ä state.json
```bash
# –í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose exec fvg-bot cat state.json

# –ö—Ä–∞—Å–∏–≤–æ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
docker-compose exec fvg-bot cat state.json | python -m json.tool
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# –í —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker-compose logs -f

# –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫
docker-compose logs --tail=50

# –ò–∑ —Ñ–∞–π–ª–∞ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose exec fvg-bot tail -f logs/live_bot.log
```

### –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose down

# –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏
rm -rf logs/*

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose up -d
```

## ‚úÖ –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–µ–π—á–∞—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
- ‚úÖ Logs —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `./logs/` –Ω–∞ —Ö–æ—Å—Ç–µ
- ‚ö†Ô∏è state.json –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–Ω–µ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–µ–Ω –ø—Ä–∏ `docker-compose down -v`)
- ‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ Docker –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ (10MB, 3 —Ñ–∞–π–ª–∞)

–î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å state.json (—Å–º. –í–∞—Ä–∏–∞–Ω—Ç 1 –≤—ã—à–µ).
